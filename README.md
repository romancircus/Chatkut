# ChatKut - AI-Powered Video Editor

An open-source chat-based video editor powered by Remotion, Dedalus SDK, and Plan-Execute-Patch architecture.

## Quick Start

### 1. Install Dependencies

```bash
npm install
```

### 2. Set Up Convex

```bash
npx convex dev
```

### 3. Configure Environment Variables

Copy `.env.example` to `.env.local` and add your credentials:

```bash
cp .env.example .env.local
```

Required environment variables:
- `CLOUDFLARE_ACCOUNT_ID`
- `CLOUDFLARE_STREAM_TOKEN`
- `CLOUDFLARE_R2_ACCESS_KEY`
- `CLOUDFLARE_R2_SECRET_KEY`
- `DEDALUS_API_KEY`
- `NEXT_PUBLIC_CONVEX_URL` (generated by `npx convex dev`)

### 4. Run Development Server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) to see the app.

## Project Structure

```
chatkut/
├── app/                    # Next.js 14 app router
│   ├── (auth)/            # Auth pages (login, signup)
│   ├── (dashboard)/       # Main app pages
│   └── api/               # API routes (webhooks)
├── components/            # React components
│   ├── chat/             # Chat interface components
│   ├── editor/           # Video editor UI
│   ├── player/           # HLS + Remotion players
│   └── upload/           # TUS upload widget
├── convex/               # Convex backend
│   ├── schema.ts         # Database schema
│   ├── compositions.ts   # Composition CRUD
│   ├── media.ts          # Cloudflare integration
│   ├── mcpProxy.ts       # MCP backend proxy
│   └── rendering.ts      # Remotion Lambda
├── lib/                  # Shared utilities
│   ├── composition-engine/
│   │   ├── planner.ts    # Edit plan generation
│   │   ├── executor.ts   # AST patching
│   │   └── selectors.ts  # Selector resolution
│   └── dedalus/          # Dedalus SDK wrappers
├── types/                # TypeScript types
│   └── composition-ir.ts # IR type definitions
└── remotion/             # Remotion compositions
    └── templates/        # Starter templates
```

## Development

### Commands

```bash
# Development
npm run dev              # Start Next.js dev server
npx convex dev          # Start Convex backend

# Testing
npm test                # Run all tests
npm run type-check      # TypeScript type checking
npm run lint            # ESLint

# Deployment
npx convex deploy       # Deploy Convex backend
vercel deploy --prod    # Deploy Next.js frontend
npx remotion lambda deploy  # Deploy Remotion Lambda
```

## Architecture

ChatKut uses a **Plan-Execute-Patch** architecture instead of full code regeneration:

1. **Plan Generation**: LLM generates structured Edit Plans (IR)
2. **Selector Resolution**: Validate and resolve element selectors
3. **AST Patching**: Apply changes via Babel AST manipulation
4. **Persistence**: Save patches for undo/redo
5. **Feedback**: Show user-friendly receipts

See `CLAUDE.md` for detailed architecture documentation.

## Implementation Progress

Follow the 8-week implementation plan in `IMPLEMENTATION_PLAN.md`.

### Week 1: Foundation + Cloudflare Setup ✅ (In Progress)
- [x] Next.js 14 project created
- [x] TypeScript strict mode configured
- [x] Tailwind CSS set up
- [x] ESLint and Prettier configured
- [ ] Convex initialized
- [ ] Cloudflare Stream + R2 configured

## Documentation

- **CLAUDE.md**: Architecture guidance for development
- **IMPLEMENTATION_PLAN.md**: Detailed 8-week roadmap
- **.claude/permissions.md**: Claude Code permissions setup
- **chatkut-prd-v3.1-production-ready.md**: Complete PRD

## License

MIT - Open Source

## Contributing

See `IMPLEMENTATION_PLAN.md` for development workflow and best practices.
